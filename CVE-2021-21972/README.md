from https://github.com/NS-Sp4ce/CVE-2021-21972

# CVE-2021-21972
CVE-2021-21972
vmware vcenter RCE
vSphere Client（HTML5）在 vCenter Server 插件中存在一个远程执行代码漏洞。未授权的攻击者可以通过开放 443 端口的服务器向 vCenter Server 发送精心构造的请求，从而在服务器上写入 webshell，最终造成远程任意代码执行

# Test On

- VMware-VCSA-all-6.7.0-8217866、VMware-VIM-all-6.7.0-8217866 On 2021-02-24 ✔
- vCenter 6.5 Linux/Window **Waiting For Test**
- vCenter 6.7 Linux/Window **Waiting For Test**
- vCenter 7.0 Linux/Window **Waiting For Test**

# Details

1. 漏洞为任意文件上传
2. 存在问题的接口为`/ui/vropspluginui/rest/services/uploadova`，完整路径（`https://domain.com/ui/vropspluginui/rest/services/uploadova`）
3. 仓库内的`payload`文件夹内的`tar`文件为默认冰蝎3 webshell

#  Screenshots

## Runtime

![3.png](/img/3.png)

## Success



![1.png](/img/1.png)

![1.png](/img/2.png)

# 声明

- 仅供安全研究
